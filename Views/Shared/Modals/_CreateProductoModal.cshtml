@* Modal para Crear Producto *@

<div id="createProductoModal" class="modal-overlay" style="display: none;">
    <div class="modal-container">
        <div class="modal-header">
            <div style="display: flex; align-items: center; gap: 0.75rem;">
                <div style="background: #0092B8; width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white;">
                    <i class="fa-solid fa-box"></i>
                </div>
                <div>
                    <h2 class="modal-title">Agregar Producto</h2>
                    <p class="modal-subtitle">Complete los datos para registrar un nuevo producto</p>
                </div>
            </div>
            <button class="modal-close" onclick="closeModal('createProductoModal')">&times;</button>
        </div>
        <form id="createProductoForm" asp-action="Create" asp-controller="Productos" method="post">
            <div class="modal-body">
                <!-- Código Automático Info -->
                <div style="background: #EFF6FF; border: 1px solid #BFDBFE; border-radius: 8px; padding: 0.75rem; margin-bottom: 1rem; display: flex; gap: 0.5rem;">
                    <i class="fa-solid fa-info-circle" style="color: #3B82F6; margin-top: 2px;"></i>
                    <div>
                        <strong style="color: #1E40AF; font-size: 13px;">Código Automático:</strong>
                        <span style="color: #1E40AF; font-size: 12px;"> Se generará automáticamente con formato PROD-XXX al crear el producto.</span>
                    </div>
                </div>

                <!-- Nombre del Producto -->
                <div class="form-group">
                    <label class="form-label">Nombre del Producto <span style="color: red;">*</span></label>
                    <input type="text" name="Nombre" class="form-control" placeholder="Ej: Arroz Costeño 1kg" required maxlength="100" />
                </div>

                <!-- Categoría y Unidad -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Categoría <span style="color: red;">*</span></label>
                        <select name="CategoriaId" id="createCategoriaId" class="form-select" required>
                            <option value="">Cargando...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Unidad de Medida <span style="color: red;">*</span></label>
                        <select name="Unidad" class="form-select" required>
                            <option value="">Seleccione...</option>
                            <option value="Unidad">Unidad</option>
                            <option value="Kilogramo">Kilogramo</option>
                            <option value="Litro">Litro</option>
                            <option value="Caja">Caja</option>
                            <option value="Docena">Docena</option>
                            <option value="Bolsa">Bolsa</option>
                            <option value="Paquete">Paquete</option>
                        </select>
                    </div>
                </div>

                <!-- Precios -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">Precio de Compra (S/) <span style="color: red;">*</span></label>
                        <input type="number" name="PrecioCompra" id="createPrecioCompra" class="form-control" placeholder="0.00" step="0.01" min="0.01" required />
                    </div>

                    <div class="form-group">
                        <label class="form-label">Precio de Venta (S/) <span style="color: red;">*</span></label>
                        <input type="number" name="PrecioVenta" id="createPrecioVenta" class="form-control" placeholder="0.00" step="0.01" min="0.01" required />
                    </div>
                </div>

                <!-- Alerta de validación de precios -->
                <div id="precioWarning" style="background: #FEF3C7; border-left: 3px solid #F59E0B; padding: 0.625rem; border-radius: 4px; margin-bottom: 1rem; display: none;">
                    <div style="display: flex; align-items: start; gap: 0.5rem;">
                        <i class="fa-solid fa-exclamation-triangle" style="color: #F59E0B; margin-top: 2px;"></i>
                        <span style="font-size: 12px; color: #92400E;">
                            El precio de venta debe ser mayor o igual al precio de compra.
                        </span>
                    </div>
                </div>

                <!-- Descripción -->
                <div class="form-group">
                    <label class="form-label">Descripción (opcional)</label>
                    <textarea name="Descripcion" class="form-control" rows="3" placeholder="Descripción adicional del producto..." maxlength="500"></textarea>
                </div>

                <!-- Nuevo Producto Info -->
                <div style="background: #ECFDF5; border: 1px solid #A7F3D0; border-radius: 8px; padding: 0.75rem; margin-top: 1rem;">
                    <div style="display: flex; align-items: start; gap: 0.5rem;">
                        <i class="fa-solid fa-check-circle" style="color: #10B981; margin-top: 2px;"></i>
                        <span style="font-size: 12px; color: #047857;">
                            El producto estará disponible inmediatamente en todos los locales activos del sistema.
                        </span>
                    </div>
                </div>

                <!-- Checkbox "Guardar y Agregar Otro" -->
                <div style="background: #ECFDF5; border: 1px solid #A7F3D0; border-radius: 8px; padding: 0.75rem; margin-top: 1rem;">
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; margin: 0;">
                        <input type="checkbox" id="guardarYAgregarOtro" style="width: 18px; height: 18px; cursor: pointer;" />
                        <span style="font-size: 13px; color: #047857; font-weight: 500;">
                            Guardar y agregar otro producto
                        </span>
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-cancel" onclick="closeModal('createProductoModal')">Cancelar</button>
                <button type="submit" class="btn btn-primary">
                    <i class="fa-solid fa-plus"></i>
                    Agregar Producto
                </button>
            </div>
        </form>
    </div>
</div>

<script>
// Validar precios en tiempo real
document.addEventListener('DOMContentLoaded', function() {
    const precioCompraInput = document.getElementById('createPrecioCompra');
    const precioVentaInput = document.getElementById('createPrecioVenta');
    const warningDiv = document.getElementById('precioWarning');

    function validarPrecios() {
        const compra = parseFloat(precioCompraInput?.value || 0);
        const venta = parseFloat(precioVentaInput?.value || 0);

        if (compra > 0 && venta > 0 && venta < compra) {
            warningDiv.style.display = 'block';
        } else {
            warningDiv.style.display = 'none';
        }
    }

    precioCompraInput?.addEventListener('input', validarPrecios);
    precioVentaInput?.addEventListener('input', validarPrecios);
});
</script>